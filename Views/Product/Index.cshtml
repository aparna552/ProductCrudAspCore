@* @model ProductManagement.Models.ProductVM *@
@model ProductManagement.Models.ProductVM
<!-- Include Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />


@{
    ViewData["Title"] = "Index";
}

<h1>
    Product add/update
</h1>
<div class="container">
    <div class="row">
        <div class="col-md-6">
            <form method="post" asp-area="" asp-controller="Product" asp-action="AddUpdateProduct">
         @Html.AntiForgeryToken()
         <input type="hidden" id="productid" name="productid" />
         <div class="row mb-3">
             <div class="col-12"><label for="productname">ProductName</label></div>
                    <div class="col-12"><input type="text" class="form-control" name="productname" id="productname" placeholder="Enter Name"></div>
         </div>
                
              <div class="row mb-3">
                    <div class="col-12"><label for="description">Description</label></div>
                    <div class="col-12"><input type="text" class="form-control" name="description" id="description" placeholder="Description"></div>
                </div>
                <div class="row mb-3">
                    <div class="col-12">
                        <button type="submit" class="btn btn-success ">Submit</button>
                </div>
                </div>

            </form>
        </div>
        <div class="col-md-6">
            @{
                if (TempData["Successmsg"]!=null)
                {
                    <h2 class="bg-success"> @TempData["Successmsg"] </h2>
                    
                }
                if (TempData["Errormsg"] != null)
                {
                   <h2 class="bg-danger"> @TempData["Errormsg"] </h2>

                }
            }

        </div>
    </div>
</div>


<h1>Product List</h1>
<div class="container">
    <table class="table table-bordered">
        <tr>
            <th>ProductId</th>
            <th>Product Name</th>
            <th>Description</th>
            <th>Date</th>
            <th>Action</th>

        </tr>
        @{
            if (Model.productsList != null && Model.productsList.Count > 0)
            {
                foreach (var item in Model.productsList)
                {
                    <tr id>
                                      <td>@item.productid</td>
                                           <td>@item.productname</td>
                                           <td>@item.description</td>
                                           <td>@item.createddate.ToString("dd-MMM-yyyy")</td>
                                           
                                        <td>
    <a onclick="DeleteProductRecord('@item.productid')" style="cursor:pointer;" title="Delete">
        <i class="fas fa-trash-alt" style="color:red;"></i>
    </a> &nbsp;
    <a onclick="UpdateProductRecord('@item.productid', '@Html.Encode(item.productname)', '@Html.Encode(item.description)')" style="cursor:pointer;" title="Edit">
        <i class="fas fa-edit" style="color:blue;"></i>
    </a>
</td>


                                                                </tr>
                }
            }
        }
    </table>
</div>

<script type="text/javascript">
    function DeleteProductRecord(productid) {
        let response = confirm("Do you want to delete this record");
        if (response) { 
            $.ajax({
                type: "POST",
                url: '@Url.Action("DeleteProduct","Product")',
                data: { productid: productid },
                success: function (response) {
                    if (response.message == "Delete Successfully") {
                        //alert("Product Deleted successfully")
                        window.location.reload();
                      //  $('#row-' + productid).remove();
                    }
                    else {
                        alert(response.message)
                    }
                },
                complete: function () { },
                failure: function (jqXHR, textStatus, errorThrown) {

                    alert("Error occured please try again ");
                }
            });
        }

    }
    function UpdateProductRecord(productid, productname, description) {
        $('#productid').val(productid);
        $('#productname').val(productname);
        $('#description').val(description);

    }


</script>

